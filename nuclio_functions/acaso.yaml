metadata:
  name: acaso
  labels: {}
  annotations: {}
spec:
  description: ""
  disable: false
  triggers:
    aCaso:
      kind: mqtt
      attributes:
        subscriptions:
          - topic: iot/sensors/temperature
            qos: 0
      workerAllocatorName: ""
      url: "guest:guest@192.168.1.7:1883"
      username: ""
      password: ""
  env: []
  handler: "main:handler"
  runtime: nodejs
  build:
    image: ""
    noCache: false
    offline: false
    dependencies: []
    runtimeAttributes:
      repositories: []
    functionSourceCode: dmFyIG1xdHQgPSByZXF1aXJlKCdtcXR0Jyk7DQoNCnZhciBGVU5DVElPTl9OQU1FID0gInRlbXBlcmF0dXJlSGFuZGxlck1xdHQiOw0KdmFyIElQID0gIjE5Mi4xNjguMS43Ig0KDQp2YXIgb3B0aW9ucyA9IHsNCiAgICBwb3J0OiAxODgzLA0KICAgIGhvc3Q6ICdtcXR0Oi8vMTkyLjE2OC4wLjE1NScsDQogICAgY2xpZW50SWQ6ICdtcXR0anNfJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnN1YnN0cigyLCA4KSwNCiAgICB1c2VybmFtZTogJ2d1ZXN0JywNCiAgICBwYXNzd29yZDogJ2d1ZXN0JywNCn07DQoNCmZ1bmN0aW9uIHNlbmRfYWN0aW9uX21xdHQodG9waWMsIHBvd2VyKSB7DQogICAgdmFyIGNsaWVudCA9IG1xdHQuY29ubmVjdCgibXF0dDovLyIgKyBJUCwgb3B0aW9ucyk7DQoNCiAgICBjbGllbnQub24oJ2Nvbm5lY3QnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIGNsaWVudC5wdWJsaXNoKHRvcGljLCBwb3dlciwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgY2xpZW50LmVuZCgpOw0KICAgICAgICB9KTsNCiAgICB9KTsNCn0NCmZ1bmN0aW9uIHNlbmRfdG9fbG9ncyh0b3BpYywgcG93ZXIsIHRlbXBlcmF0dXJlLCBkZXNjcmlwdGlvbikgew0KICAgIHZhciBjbGllbnQgPSBtcXR0LmNvbm5lY3QoIm1xdHQ6Ly8iICsgSVAsIG9wdGlvbnMpOw0KDQogICAgY2xpZW50Lm9uKCdjb25uZWN0JywgZnVuY3Rpb24gKCkgew0KICAgICAgICBjbGllbnQucHVibGlzaCh0b3BpYywgcG93ZXIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGNsaWVudC5lbmQoKTsNCiAgICAgICAgfSk7DQogICAgfSk7DQp9DQoNCmZ1bmN0aW9uIGJpbjJzdHJpbmcoYXJyYXkpIHsNCiAgICB2YXIgcmVzdWx0ID0gIiI7DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7ICsraSkgew0KICAgICAgICByZXN1bHQgKz0gKFN0cmluZy5mcm9tQ2hhckNvZGUoYXJyYXlbaV0pKTsNCiAgICB9DQogICAgcmV0dXJuIHJlc3VsdDsNCn0NCg0KZXhwb3J0cy5oYW5kbGVyID0gZnVuY3Rpb24gKGNvbnRleHQsIGV2ZW50KSB7DQogICAgdmFyIF9ldmVudCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZXZlbnQpKTsNCiAgICB2YXIgX2RhdGEgPSBiaW4yc3RyaW5nKF9ldmVudC5ib2R5LmRhdGEpOw0KDQogICAgY29uc29sZS5sb2coIlRSSUdHRVIgIiArIF9kYXRhKTsNCiAgICB2YXIgdGVtcGVyYXR1cmUgPSBOdW1iZXIoX2RhdGEpDQogICAgdmFyIGFjdGlvbiA9IHt9DQogICAgdmFyIHRvcGljID0gIiINCiAgICB2YXIgcG93ZXIgPSAiMCINCg0KICAgIGlmICh0ZW1wZXJhdHVyZSA8PSAyNSAmJiB0ZW1wZXJhdHVyZSA+PSAyMCkgew0KICAgICAgICAvLyBub24gZGV2byBmYXJlIG51bGxhLCBhbCBtYXNzaW1vIHN0b3BwbyB0dXR0bw0KDQogICAgICAgIHZhciB0b3BpYzEgPSAiaW90L2RldmljZXMvY29uZGl0aW9uZXIiDQogICAgICAgIHZhciB0b3BpYzIgPSAiaW90L2RldmljZXMvdGhlcm1vc3RhdCINCiAgICAgICAgcG93ZXIgPSAiMCINCiAgICAgICAgZGVzY3JpcHRpb24gPSAic3RvcCINCg0KICAgICAgICBzZW5kX2FjdGlvbl9tcXR0KHRvcGljMSwgcG93ZXIpOw0KICAgICAgICBzZW5kX2FjdGlvbl9tcXR0KCB0b3BpYzIsIHBvd2VyKTsNCg0KICAgICAgICB0b3BpYyA9ICJpb3QvZGV2aWNlcy90YWJsZXQiDQogICAgICAgIHNlbmRfdG9fbG9ncyh0b3BpYywgcG93ZXIsIHRlbXBlcmF0dXJlLCBkZXNjcmlwdGlvbik7DQoNCiAgICAgICAgY29udGV4dC5jYWxsYmFjaygiZmVlZGJhY2sgIiArIGFjdGlvbi50b3BpYykNCg0KICAgIH0NCiAgICBlbHNlIHsNCg0KICAgICAgICAvLyBUT0RPOiBjYW1iaWFyZSBjb24gY29zdGFudGkgaSB2YWxvcmkgbnVtZXJpY2kNCiAgICAgICAgLy8gZGV2byBhYmJhc3NhcmUgbGEgdGVtcGVyYXR1cmEgICAgDQogICAgICAgIGlmICh0ZW1wZXJhdHVyZSA+IDI1KSB7DQogICAgICAgICAgICBpZiAodGVtcGVyYXR1cmUgPCAzMCkNCiAgICAgICAgICAgICAgICBwb3dlciA9ICIxIjsNCiAgICAgICAgICAgIGVsc2UgaWYgKHRlbXBlcmF0dXJlIDwgMzUpDQogICAgICAgICAgICAgICAgcG93ZXIgPSAiMiI7DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgcG93ZXIgPSAiMyI7DQogICAgICAgICAgICB0b3BpYyA9ICJpb3QvZGV2aWNlcy9jb25kaXRpb25lciINCiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gImRvd24iDQogICAgICAgIH0NCg0KICAgICAgICAvLyBkZXZvIGFsemFyZSBsYSB0ZW1wZXJhdHVyYQ0KICAgICAgICBpZiAodGVtcGVyYXR1cmUgPCAyMCkgew0KICAgICAgICAgICAgaWYgKHRlbXBlcmF0dXJlID4gMTUpDQogICAgICAgICAgICAgICAgcG93ZXIgPSAiMSI7DQogICAgICAgICAgICBlbHNlIGlmICh0ZW1wZXJhdHVyZSA+IDEwKQ0KICAgICAgICAgICAgICAgIHBvd2VyID0gIjIiOw0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHBvd2VyID0gIjMiOw0KICAgICAgICAgICAgdG9waWMgPSAiaW90L2RldmljZXMvdGhlcm1vc3RhdCINCiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gInVwIg0KICAgICAgICB9DQoNCiAgICAgICAgYWN0aW9uID0gew0KICAgICAgICAgICAgdG9waWNUb0xvZzogImlvdC9kZXZpY2VzL3RhYmxldCIsDQogICAgICAgICAgICB0b3BpYzogdG9waWMsDQogICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGVtcGVyYXR1cmUsDQogICAgICAgICAgICBwb3dlcjogcG93ZXINCiAgICAgICAgfTsNCg0KICAgICAgICBjb250ZXh0LmNhbGxiYWNrKCJmZWVkYmFjayAiICsgYWN0aW9uLnRvcGljKQ0KDQogICAgICAgIHNlbmRfYWN0aW9uX21xdHQoYWN0aW9uLnRvcGljLCBhY3Rpb24ucG93ZXIpOw0KICAgICAgICAvL3NlbmRfdG9fbG9ncyhhY3Rpb24udG9waWNUb0xvZywgYWN0aW9uLnBvd2VyLCBhY3Rpb24udGVtcGVyYXR1cmUsIGFjdGlvbi5kZXNjcmlwdGlvbik7DQogICAgfQ0KfQ0K
    codeEntryType: sourceCode
    commands:
      - 'npm install mqtt'
  targetCPU: 75
  minReplicas: 1
  maxReplicas: 1
  readinessTimeoutSeconds: 60
